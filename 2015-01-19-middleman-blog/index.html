<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv='X-UA-Compatible' content='IE=edge;chrome=1' />
    <meta name = "viewport" content = "width = device-width, user-scalable = yes">
    <title>middleman-blogでブログを開設する - nrtkbb blog</title>
    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/atom.xml" />
    
      <link href="/css/all.css?1422190900" media="screen" rel="stylesheet" type="text/css" />
    
  </head>
  <body>
    <header>
      <div id="site-title">
        <h1><a href="/"><b class="nrtkbb">nrtkbb</b><b class="blog">blog</b></a></h1>
      </div>
    </header>
    <nav>
      <ul>
        <li><a href="/">Home</a></li>
        <li><a href="/atom.xml">RSS</a></li>
      </ul>
    </nav>

    <div id="main" role="main">
        <article>
    <h2><a href="/2015-01-19-middleman-blog/">middleman-blogでブログを開設する</a></h2>
    <aside>
      <time>Published on 2015.01.19</time>
      
      
        <ul class="tags">
          
            <li><a href="/tags/blog/">blog</a></li>
          
            <li><a href="/tags/middleman/">middleman</a></li>
          
        </ul>
      
    </aside>
    <div id="blog-body">
      <p>middleman-blogを使い始めてるにあたってmiddleman-blog以前というか、周辺知識に乏しかった過去の自分のために、どこを調べれば良いかとか、なんでそれ使うの？という超初心者に向けた解説があったら助かったなーと感じてたので、メインの内容はそっちになります</p>

<p></p>

<h3 id="toc_0">僕の環境</h3>

<ul>
<li>MacOSX</li>
<li><code>homebrew</code>インストール済み</li>
</ul>

<h3 id="toc_1">Rubyのインストールのためのrbenv</h3>

<p>まずはRubyのインストールから<br>
MacOSXには初めから古いRubyがあるけど新しいものを使う</p>

<p>今なら<code>rbenv</code>を使ってRubyをインストールする<br>
<code>rbenv</code>を使うモチベーションになるわかりやすい利点があったので引用</p>

<ul>
<li><a href="http://tech-sketch.jp/2014/04/rbenvで複数バージョンのrubyを管理する.html">rbenvで複数バージョンのRubyを管理する</a></li>
</ul>

<blockquote>
<p>・新しいバージョンのRubyの機能を試したい<br>
・新しいバージョンでアプリケーションの動作確認がしたい<br>
・Rubyを古いバージョンに一時的に戻したい<br>
・アプリケーションごとに使いたいバージョンが異なる</p>
</blockquote>

<p>もう一つ利点を追加するとRubyをインストールするからには<code>gem</code>と言われるRubyで作られたパッケージをいくつもインストールしてやりたいことをする。なんてことがとても多くなる。<code>middleman</code>もその<code>gem</code>の一つ</p>

<p><code>gem</code>は、Rubyのバージョンに強く紐付いてるからRubyのバージョンを上げようと思ったら、インストールしてある<code>gem</code>は当然動かなくなる。(Rubyのバージョンは結構すぐ上がる)</p>

<p><code>rbenv</code>を使ってRubyのインストールを行っていれば<code>gem</code>をインストールする時も、アクティブになっているRubyのバージョンと同じところに<code>gem</code>をインストールするようになる</p>

<p><code>rbenv</code>はRubyのバージョンを切り替えながら、実はこの<code>gem</code>も切り替えてる</p>

<p>そういった背景があるので<code>rbenv</code>をインストールしてRuby(と<code>gem</code>)を管理する</p>
<pre class="highlight shell"><code><span class="c"># homebrewを使ってrbenvをインストール</span>
<span class="gp">$ </span>brew updage
<span class="gp">$ </span>brew install rbenv ruby-build
<span class="gp">$ </span><span class="nb">echo</span> <span class="s1">'eval "$(rbenv init -)"'</span> &gt;&gt; ~/.bash_profile
<span class="gp">$ </span><span class="nb">source</span> ~/.bash_profile

<span class="c"># rbenvを使ってRubyをインストール</span>
<span class="gp">$ </span>rbenv install 2.1.4
<span class="gp">$ </span>rbenv global 2.1.4
<span class="gp">$ </span>rbenv rehash
</code></pre>

<ul>
<li><a href="http://qiita.com/a_ishidaaa/items/8cc14453289dba1413dd">[rbenv]コマンド備忘録 - Qiita</a></li>
</ul>

<p><strong>2015-01-25追記</strong><br>
<a href="http://railstutorial.jp/">Railsチュートリアル</a>をやっていたら<code>rbenv</code>のもっと良い解説記事を見つけたのでそれも紹介しておく</p>

<ul>
<li><a href="http://niwatako.tips/20140724/article121.html">rbenvつかってrailsチュートリアルやってみよう！ | niwatako$</a></li>
</ul>

<p><strong>追記おわり</strong></p>

<h3 id="toc_2">Bundlerのインストール</h3>

<p>Rubyをインストールしたら、同時に<code>bundler</code>をインストールする<br>
<code>bundler</code>を使う利点は以下の記事を参照</p>

<ul>
<li><a href="http://shokai.org/blog/archives/7262">Ruby書くならBundler使え</a></li>
</ul>
<pre class="highlight shell"><code><span class="gp">$ </span>gem install bundle
</code></pre>

<h3 id="toc_3">middlemanとmiddleman-blogのインストール</h3>

<p>まずはBundlerを使わずに、普通にインストールする<br>
後述するmiddleman-blogのプロジェクトテンプレートを展開するコマンドのために、どうしてもシステムワイドにインストールが必要なんだよね。このへんややこしい<br>
Bundler管理下のmiddlemanと、OSへインストールされた(普通に<code>gem install middleman</code>とインストールした)middlemanを混同しないようにする</p>
<pre class="highlight shell"><code><span class="gp">$ </span>gem install middleman
<span class="gp">$ </span>gem install middleman-blog
</code></pre>

<h3 id="toc_4">プロジェクトテンプレートを利用して作業を開始する</h3>

<p>Middlemanには色々なテンプレートが用意されていて、テンプレートを元にひな形をポコっと作って作業を開始することが出来る<br>
<code>middleman-blog</code>もその一つ</p>
<pre class="highlight shell"><code><span class="gp">$ </span>middleman init BLOG_DIR_NAME --template<span class="o">=</span>blog --skip-bundle
</code></pre>

<p><code>BLOG_DIR_NAME</code>を指定しないと、カレントディレクトリに色んなファイルやディレクトリが展開されてしまう。作業ディレクトリを掘ってからその中で実行するか、上記のように作業ディレクトリ名を指定して実行しないとひどいことになる(なった)</p>

<p><code>--template=blog</code>と指定してるのがプロジェクトテンプレート名にあたる<br>
今回はブログを開始するので<code>blog</code>を指定</p>

<p>※ちなみにMiddlemmanはブログ以外にも様々な目的で使用されていて、そのためのプロジェクトテンプレートもいくつか用意されてる</p>

<ul>
<li><a href="http://directory.middlemanapp.com/#/templates/all">Middleman Directory</a></li>
</ul>

<p><code>--skip-bundle</code>は、プロジェクトテンプレートの展開と同時にMiddlemanが勝手に<code>bundle install</code>を実行してしまうのを防ぐため。これは好みの問題なので、正直どちらでも良い</p>

<p>さて、プロジェクトテンプレートが展開されたので中に入って見てみる</p>
<pre class="highlight shell"><code><span class="gp">$ </span><span class="nb">cd </span>blog-dir-name
<span class="gp">$ </span>tree
.
├── Gemfile
├── config.rb
└── <span class="nb">source</span>
    ├── 2012-01-01-example-article.html.markdown
    ├── calendar.html.erb
    ├── feed.xml.builder
    ├── images
    ├── index.html.erb
    ├── javascripts
    ├── layout.erb
    ├── stylesheets
    └── tag.html.erb

4 directories, 8 files
</code></pre>

<p><strong>Gemfile</strong><br>
使用したい<code>gem</code>を記載するところ<br>
変更したら<code>bundle update</code>を実行する<br>
Gemfileの書き方は色々あって、すごく良くまとまってる記事があるのでこれを参考にすると良いと思う</p>

<ul>
<li><a href="http://xxxcaqui.hatenablog.com/entry/2013/02/11/013421">Gemfileについて調べてみた - xxxcaqui.log</a></li>
</ul>

<p><strong>config.rb</strong><br>
グローバル設定的なところ<br>
middleman関連の<code>gem</code>は全部ここに設定を書き込んでおくと参照してくれるようになる<br>
設定を書くところだけど、普通にRubyのファイルなのでここでゴニョゴニョと変数を作っておけばテンプレートからも使用できる変数になる<br>
ブログ関連の設定は公式サイトを参考にすると良いと思う</p>

<ul>
<li><a href="https://middlemanapp.com/jp/basics/blogging/">Middleman: ブログ機能</a></li>
</ul>

<p><strong>source</strong><br>
ここには見慣れた見慣れたファイルが入ってるのでこの辺を編集していくことになる
軌道に乗ってしまえば後はここの中の作業が中心になるはず</p>

<p><strong>.erb</strong><br>
この拡張子はテンプレートエンジンのもので、Rails界隈で見られる<br>
ビルドすると<code>.erb</code>を取ったファイルに展開される<br>
書き方（というか読み方も）はRailsのドキュメントがわかりやすかった<br>
今なら<a href="http://slim-lang.com/">Slim</a>とか<a href="http://haml.info/">haml</a>とかの方が流行ってるので書きなおしても良いかもしれない</p>

<ul>
<li><a href="http://railsdoc.com/view">ビュー(view) - Railsドキュメント</a></li>
</ul>

<p>とりあえずは何も変更せず、素の状態を見れるようにするために<code>bundle install</code>を行って、作業用サーバを立ち上げる</p>
<pre class="highlight shell"><code><span class="gp">$ </span>bundle install --path<span class="o">=</span>bundle
<span class="gp">$ </span>bundle <span class="nb">exec </span>middleman server
</code></pre>

<p>Bundler管理下に置かれたmiddlemanを実行したいので<code>bundle exec</code>をコマンドの先頭に追加してある</p>

<p>そうすると<code>http://localhost:4567/</code>に<s>ものすっごい殺風景な</s>シンプルなサイトが立ち上がる<br>
あとは煮るなり焼くなりすればいい</p>

    </div>
    <aside class="buttons">
      <ul>
        <li class="t"><a href="https://twitter.com/share" class="twitter-share-button">Tweet</a></li>
        <li class="h"><a href="http://b.hatena.ne.jp/entry/blog.nrtkbb.com/2015-01-19-middleman-blog/" class="hatena-bookmark-button" data-hatena-bookmark-title="nrtkbb blog" data-hatena-bookmark-layout="standard-balloon" data-hatena-bookmark-lang="ja" title="このエントリーをはてなブックマークに追加"><img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" /></a></li>
        <li class="f"><div class="fb-like" data-href="http://blog.nrtkbb.com/2015-01-19-middleman-blog/" data-layout="button_count" data-action="like" data-show-faces="false" data-share="false"></div></li>
      </ul>
    </aside>
    <aside>
      <time>Published on 2015.01.19</time>
      
      
        <ul class="tags">
          
            <li><a href="/tags/blog/">blog</a></li>
          
            <li><a href="/tags/middleman/">middleman</a></li>
          
        </ul>
      
    </aside>
  </article>
  
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
  
  <script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
  
  <div id="fb-root"></div>
  <script>(function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/ja_JP/sdk.js#xfbml=1&version=v2.0";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));</script>

    </div>

    <footer>
      <ul>
        <li><a href="https://twitter.com/nrtkbb">Twitter</a></li>
        <li><a href="https://github.com/nrtkbb">Github</a></li>
      </ul>
    </footer>
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-58839528-1', 'auto');
    ga('send', 'pageview');
    </script>
  </body>
</html>
